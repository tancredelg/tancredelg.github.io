---
import type { ExperienceProps } from '../data/experiences'

const { company, positions } = Astro.props as ExperienceProps

// Helper to format date range
function formatDateRange(fromDate: string, toDate?: string): string {
    if (!toDate) return `${fromDate} - Present`
    return `${fromDate} - ${toDate}`
}
---

<div class="experience-card group/card">
    <h3 class="flex gap-2 items-center font-medium text-xl sm:text-3xl lg:text-2xl">
        {company.logo && <img id="logo" src={company.logo.src} alt={company.logo.alt} />}
        {company.name}
    </h3>
    <div id="positions">
        {
            positions.map((position, index) => (
                <div class="position-item relative group/position">
                    {index < positions.length - 1 && <div id="timeline-line" aria-hidden="true" />}
                    <div id="timeline-dot" aria-hidden="true" />
                    <div id="content">
                        <div class="flex flex-col sm:flex-row sm:items-center gap-x-2.5 gap-y-0.5">
                            <h4>{position.title}</h4>
                            <span id="period">
                                {formatDateRange(position.fromDate, position.toDate)}
                            </span>
                        </div>
                        <p>{position.description}</p>
                    </div>
                </div>
            ))
        }
    </div>

    <div id="urls">
        {
            company.url ? (
                <a
                    href={company.url}
                    target="_blank"
                    class="flex gap-1 items-center bg-white text-neutral-900"
                >
                    Website
                    <img
                        src="/images/open-link.svg"
                        alt={'"Open link" SVG'}
                        class="size-4 sm:size-4.5 lg:size-4"
                    />
                </a>
            ) : (
                <span
                    title="Feel free to contact me for more information"
                    class="p-1 px-2 rounded-lg bg-black/85 text-gray-300/85 text-sm
                    opacity-0 group-hover/card:opacity-100
                    transition-all duration-100 ease-out"
                >
                    No links available, sorry!
                </span>
            )
        }
    </div>
</div>
