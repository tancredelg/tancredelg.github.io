---
import type { EducationProps } from '../data/education'

const { institution, degree, fromDate, toDate, description } = Astro.props as EducationProps

// Helper to format date range
function formatDateRange(fromDate: string, toDate?: string): string {
    if (!toDate) return `${fromDate} - Present`
    return `${fromDate} - ${toDate}`
}
---

<div class="education-card group/card">
    <h3 class="flex gap-2 items-center font-medium text-xl sm:text-3xl lg:text-2xl">
        {
            institution.logo &&
                (() => {
                    if (institution.logo.type === 'img' && institution.logo.value) {
                        // Raster image or imported asset
                        const src =
                            typeof institution.logo.value === 'string'
                                ? institution.logo.value
                                : institution.logo.value.src
                        return <img id="logo" src={src} alt={institution.name + ' logo'} />
                    }
                    if (
                        institution.logo.type === 'svg' &&
                        typeof institution.logo.value === 'function'
                    ) {
                        // Imported SVG as component
                        const LogoComponent = institution.logo.value
                        return <LogoComponent id="logo" alt={institution.name + ' logo'} />
                    }
                    if (
                        institution.logo.type === 'html' &&
                        typeof institution.logo.value === 'string'
                    ) {
                        // Raw HTML string
                        return <div id="logo" set:html={institution.logo.value} />
                    }
                    return null
                })()
        }
        {institution.name}
    </h3>
    <div id="content">
        <div class="flex flex-col sm:flex-row sm:items-center gap-x-2.5 gap-y-0.5">
            <h4>{degree}</h4>
            <span id="period">
                {formatDateRange(fromDate, toDate)}
            </span>
        </div>
        <p set:html={description} />
    </div>

    <div id="urls">
        {
            institution.url ? (
                <a
                    href={institution.url}
                    target="_blank"
                    class="flex gap-1 items-center bg-white text-neutral-900"
                >
                    Website
                    <svg
                        class="size-4 sm:size-4.5 lg:size-4"
                        viewBox="0 0 360 360"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path d="M128,63.999444 L128,106.666444 L42.6666667,106.666667 L42.6666667,320 L256,320 L256,234.666444 L298.666,234.666444 L298.666667,362.666667 L4.26325641e-14,362.666667 L4.26325641e-14,64 L128,63.999444 Z M362.666667,1.42108547e-14 L362.666667,170.666667 L320,170.666667 L320,72.835 L143.084945,249.751611 L112.915055,219.581722 L289.83,42.666 L192,42.6666667 L192,1.42108547e-14 L362.666667,1.42108547e-14 Z" />
                    </svg>
                </a>
            ) : (
                <span
                    title="Feel free to contact me for more information"
                    class="p-1 px-2 rounded-lg bg-black/85 text-gray-300/85 text-sm
                    opacity-0 group-hover/card:opacity-100
                    transition-all duration-100 ease-out"
                >
                    No links available, sorry!
                </span>
            )
        }
    </div>
</div>
